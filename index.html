<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
       "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>PyLJFluid: Classical Fluid Simulations with Python</title>
    <link rel="StyleSheet" href="style.css" type="text/css" media="Screen">
    <link rel="StyleSheet" href="pygments_style.css" type="text/css" media="Screen">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
  </head>
  <body>
    
    <h1 id="head"><a href="https://github.com/matthagy/PyLJFluid"><span><b>PyLJFluid</b>: Classical Fluid Simulations with Python </span></a></h1>

    <div id="explain">
      <h2>
        Reproduce and extend the original computer &ldquo;<i>experiments</i>&rdquo; with Lennard-Jones
        fluids using modern tools.
      </h2>

      <a id="getsource" href="https://github.com/matthagy/PyLJFluid">Get the source on github<a/>

<div class="syntax"><pre><span class="sd">&#39;&#39;&#39;Simulate a Lennard-Jones fluid and plot the computed g(r)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">pyljfluid.components</span> <span class="kn">import</span> <span class="p">(</span><span class="n">LJForceField</span><span class="p">,</span> <span class="n">Config</span><span class="p">,</span> <span class="n">MDSimulator</span><span class="p">,</span>
                                  <span class="n">StaticPairCorrelationCalculator</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># Parameters</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">forcefield</span> <span class="o">=</span> <span class="n">LJForceField</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">r_cutoff</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">r_neighbor_skin</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">sigma</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mi">48</span> <span class="o">*</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">sigma</span> <span class="o">**</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.032</span>

<span class="c"># Initialize system</span>
<span class="n">config0</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">forcefield</span><span class="o">.</span><span class="n">sigma</span><span class="p">,
                       </span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">)</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">MDSimulator</span><span class="p">(</span><span class="n">config0</span><span class="p">,</span> <span class="n">forcefield</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">r_skin</span><span class="o">=</span><span class="n">r_neighbor_skin</span><span class="p">)</span>

<span class="c"># Equilibrate</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">randomize_velocities</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;equilibrate cycle i=</span><span class="si">%03d</span><span class="s"> U=</span><span class="si">%.3f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">evaluate_potential</span><span class="p">())</span>

<span class="c"># Compute g(r)</span>
<span class="n">gr_calc</span> <span class="o">=</span> <span class="n">StaticPairCorrelationCalculator</span><span class="p">(</span><span class="n">dr</span><span class="o">=</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
                                          <span class="n">r_max</span><span class="o">=</span><span class="n">config0</span><span class="o">.</span><span class="n">box_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;compute cycle i=</span><span class="si">%04d</span><span class="s"> H=</span><span class="si">%.4f</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">evaluate_hamiltonian</span><span class="p">())</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">gr_calc</span><span class="o">.</span><span class="n">accumulate_config</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
<span class="n">gr</span> <span class="o">=</span> <span class="n">gr_calc</span><span class="o">.</span><span class="n">get_accumulated</span><span class="p">()</span>

<span class="c"># Plot g(r)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">gr</span><span class="o">.</span><span class="n">g</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Pair Separation, $r$ ($\sigma$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Reduced Pair Density, $g(r)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>

    <div id="results">
      <img src="animate2.gif" alt="LJ simulation snapshots"/>
      <img src="gr.png" alt="pair correlation function g(r) results"/>
      <img src="virial.png" alt="reduced pressure (virial) results"/>
    </div>

  </body>
</html>

